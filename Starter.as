package {	import flash.display.MovieClip;	import flash.display.StageAlign;    import flash.display.StageScaleMode;	import flash.xml.XMLDocument;	import flash.xml.XMLNode;	import flash.events.*;	import flash.utils.*;	import flash.net.URLLoader;	import flash.net.URLRequest;	import flash.net.navigateToURL;	import flash.system.Security;	import flash.external.ExternalInterface;		import FlxerGallery.core.ThumbSaver;	import FlxerGallery.core.FlxerGallery;	import FlxerGallery.comp.Alt;		public class Starter extends MovieClip {		public var myFlxerGallery;		var cnt		var myLoader		var c;		public var home;		public var myAlt;		public function Starter() {			stage.scaleMode = StageScaleMode.NO_SCALE;			stage.align = StageAlign.TOP_LEFT;			Security.allowDomain("*");			c = setInterval(controlla, 100);		}				function controlla() {			if (stage.stageHeight > 0) {				clearInterval(c);				starterDue();			}		}				function starterDue() {			Preferences.createPref(stage.stageWidth,stage.stageHeight)			this.myFlxerGallery  = new FlxerGallery();			this.addChild(myFlxerGallery)			this.myAlt  = new Alt();			this.addChild(myAlt);			Preferences.pref.myAlt = myAlt;			this.avviaJs(root.loaderInfo.parameters.cnt);			if (ExternalInterface.available) {				ExternalInterface.addCallback("avviaJs",avviaJs);			}		}		public function avviaJs(cnt) {			// TEST LOCALE			if (!cnt) {				// single				cnt = "http://www.flxer.net/warehouse/_flxer/library/no_hole/test_motion_0.swf,test+motion";				// single foto				cnt = "http://dev.flxer.net/_fp/fpGallery.php?id=p6143";				// single flv				cnt = "http://dev.flxer.net/warehouse/_videos/lpmenzimi.flv,test+motion";				// single swf user				cnt = "http://dev.flxer.net/warehouse/_flxer/library/no_hole/test_motion_0.swf,test+motion,1,15112,6509";				// multifoto + video				cnt = "http://dev.flxer.net/_fp/fpGallery.php?id=a78";				// solo video				cnt = "http://www.flxer.net/_fp/fpGallery.php?id=p5600";				// mp3				cnt = "http://dev.flxer.net/_fp/fpGallery.php?id=p220";				// multifoto + video				cnt = "http://dev.flxer.net/_fp/fpGallery.php?id=a1";				// multi swf				cnt = "http://www.flxer.net/_fp/fpGallery.php?id=m1";				// solo video avm1				cnt = "http://www.bjcem.org/_fp/fpGallery.aspx?cnt=5102";				// solo video avm1				cnt = "http://www.flxer.net/_fp/fpGallery.php?id=p6090";				//				cnt = "http://tasia.flyer.it/_fp/fpGallery.php?id=p-9-4";				cnt = "http://tasia.flyer.it/_fp/fpGallery.php?id=p-9-1";				cnt = "http://www.liveperformersmeeting.net/warehouse/lpmgallery/2007/PreviewPalazzo.xml";				cnt = "http://tasia.ecode.it/warehouse/_videos/the_end_sunset.flv,make+your+snapshot";				cnt = "http://livevisuals.flyer.it/_fp/fpGallery.php?id=av-280-13";				cnt = "http://jenet.flyer.it/warehouse/_audio/il_pranzo__servito.mp3";				cnt = "http://www.liveperformersmeeting.net/warehouse/lpmgallery/selecta.xml";				cnt = "http://tasia.flyer.it/_fp/fpGallery.php?id=p-9-1";				// solo video avm2				cnt = "http://www.flxer.net/_fp/fpGallery.php?id=v31-14-7149";				cnt = "http://www.liveperformersmeeting.net/2008/location/location.xml";				cnt = "http://www.flxer.net/_fp/fpGallery.php?id=p1063";				// multifoto + video				cnt = "http://www.flxer.net/_fp/fpGallery.php?id=a78";				// multifoto				cnt = "http://dev.natgeoadventure.it/_fp/fpGallery.php?id=p9091";				cnt = "http://misael.flyer.it/_fp/fpGallery.php?id=s18";				cnt = "../../../Documents/Provincia/data2.xml";				cnt = "IntDelGobbo-19-04-08.mov";				cnt = "http://dev.natgeoadventure.it/_fp/fpGallery.php?id=m20";				cnt = "http://vivofilm.flyer.it/wp-content/uploads/2008/07/il-mio-paese-clip-gela3.flv,Ilmiopaese";				cnt = "http://www.flxer.net/warehouse/_videos/lpmenzimi.flv,test+motion";				cnt = "http://www.natgeoadventure.it/_fp/fpGallery.php?id=p10061";				cnt = "http://www.bjcem.org/_fp/fpDBGallery.aspx?cnt=538|fr|athene2003|2003";				cnt = "http://www.bjcem.org/_fp/fpDBGallery.aspx?cnt=417|fr|athene2003|2003";				cnt = "http://www.natgeoadventure.it/_fp/fpGallery.php?id=p10681";				cnt = "http://62.149.162.25/deinz/files/inhalt.php?WHERE=Video.id%3D6&amp;r=25939936";				cnt = "http://www.liveperformersmeeting.net/warehouse/lpmgallery/2008mex/2008-08-28_Preview@ParqueJuarez.xml";				//cnt = "http://www.bjcem.org/_fp/fpDBGallery.aspx?cnt=610|fr|athene2003|2003";				//clearInterval(c);				//c = setInterval(avviaJs, 5000, "http://dev.natgeoadventure.it/warehouse/blog/video/post_video_9091.flv,corsa");				cnt = "http://matera.kpr-key.it/_fp/fpGallery.php?id=m81";				cnt = "http://www.flxer.net/_fp/fpGallery.php?id=r476";				cnt = "http://62.149.162.25/deinz/files/inhalt.php?WHERE=Video.id%3D80";			}			Preferences.updatePref(cnt)			var tmp = cnt.split(",");			var tmp2 = tmp[0].substring(tmp[0].length-3, tmp[0].length).toLowerCase();			home = new XMLDocument();			home.ignoreWhite = true;			if (tmp2 == "flv" || tmp2 == "mp3" || tmp2 == "mp4" || tmp2 == "swf" || tmp2 == "jpg" || tmp2 == "png" || tmp2 == "gif") {				if (tmp[2]) {					xmlStr = "<root autostop=\"false\"><item page_url=\""+tmp[2]+"\"><file>"+tmp[0]+"</file><data><tit>"+tmp[1]+"</tit></data></item></root>";				} else {					xmlStr = "<root autostop=\"false\"><item><file>"+tmp[0]+"</file><data><tit>"+tmp[1]+"</tit></data></item></root>";				}				home.parseXML(xmlStr);				this.myFlxerGallery.avvia();			} else {				myLoader = new URLLoader(new URLRequest(cnt));				myLoader.addEventListener("complete", avviaMyFlxerGallery);				myLoader.addEventListener("ioError", loadErr);			}		}		// PREFERENZE		function loadErr(event) {			trace("event"+event)			if (ExternalInterface.available) {				ExternalInterface.call("alert", "Error loading content.");			} else {				navigateToURL(new URLRequest("javascript:alert('Error loading content.')"));			}		}		function avviaMyFlxerGallery(event) {			home.parseXML(myLoader.data);			trace(home);			if (event.type == "complete") {				for (var a = 0; a<home.childNodes[0].childNodes.length; a++) {					home.childNodes[0].childNodes[a].childNodes[0].childNodes[0].nodeValue = Preferences.pref.myPath+home.childNodes[0].childNodes[a].childNodes[0].childNodes[0].toString();					home.childNodes[0].childNodes[a].childNodes[2].childNodes[0].nodeValue = Preferences.pref.myPath+home.childNodes[0].childNodes[a].childNodes[2].childNodes[0].toString();				}				for (var item in home.childNodes[0].attributes) {					val = home.childNodes[0].attributes[item]					if (val == parseFloat(val).toString()) {						val = parseFloat(val);					} else if (val == "true") {						val = true;					} if (val == "false") {						val = false;					}					Preferences.pref[item] = val;					trace("NEW "+item+" "+Preferences.pref[item])				}				//Preferences.pref.thumbSaver = true;				Preferences.updatePrefPath();				this.myFlxerGallery.avvia();			} else {				loadErr("xmlLoadError");/**/			}		}		public static function myReplace(str, search, replace) {			var temparray = str.split(search);			str = temparray.join(replace);			return str;		}	}}